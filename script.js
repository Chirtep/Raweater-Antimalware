//stars

function stars(selector) {
    const starWrapper = document.querySelector(selector)

    for (let i = 0; i < 4; i++) {
        starWrapper.innerHTML += `<img src='img/svg/Star.svg' alt='star'/>`
    }
    starWrapper.innerHTML += `<img src='img/svg/Half-star.svg' alt='star'/>`
}

stars('.review-icon__wrapper')


//OS

const OS = ['img/svg/windows_logos_PNG25.svg', 'img/svg/1280px-MacOS_wordmark_(2017).svg', 'img/svg/Android_symbol_green_RGB.svg', 'img/svg/IOS_logo_2010.svg'],
    OSWrapper = document.querySelector('.os')
OS.forEach((item, index) => OSWrapper.innerHTML += `<div class="icon__wrapper icon__wrapper${index}"><img src=${item} alt='OS' class="os_icon"/></div>`)


// products list

const selectBody = document.querySelector('.select__body'),
    selectCurrent = document.querySelector('.select__current')

const gbp = ['1 Device, 1 Year £27.99', '1 Device, 2 Years £43.99', '3 Devices, 1 Year £35.99', '3 Devices, 2 Years £63.99', '5 Devices, 1 Year £43.99', '5 Devices, 2 Years £71.99'],
    usd = ['1 Device, 1 Year $34.99', '1 Device, 2 Years $54.99', '3 Devices, 1 Year $44.99', '3 Devices, 2 Years $79.99', '5 Devices, 1 Year $54.99', '5 Devices, 2 Years $89.99'],
    eur = ['1 Device, 1 Year €32.99', '1 Device, 2 Years €51.99', '3 Devices, 1 Year €42.99', '3 Devices, 2 Years €75.99', '5 Devices, 1 Year €51.99', '5 Devices, 2 Years €84.99']

function pricesCurrency(arr) {
    const pricesArr = arr,
        body = selectBody

    selectCurrent.innerHTML = `${pricesArr[0]}`
    pricesArr.forEach(item => body.innerHTML += `<div class="select__item">${item}</div>`)
}

pricesCurrency(gbp)

// prices

function price(currency) {
    const priceCurrent = document.querySelector('.price__current'),
        priceOld = document.querySelector('.price__old'),
        initialPrice = selectCurrent.innerText.substr(-5, 5)

    priceCurrent.innerHTML = `${currency}${initialPrice}`
    priceOld.innerHTML = `${currency}${(Number(initialPrice) - 1.00).toFixed(2)}`
}

price('£')

function selectHandler(a, b, c, selectedOption) {
    return selectedOption.text === 'GBP' ? a : selectedOption.text === 'USD' ? b : c
}

function currencySwitch(selectedOption) {
    selectBody.innerHTML = ''
    selectCurrent.innerHTML = ''

    pricesCurrency(selectHandler(gbp, usd, eur, selectedOption))

    price(selectHandler('£', '$', '€', selectedOption))

    select(selectHandler('£', '$', '€', selectedOption))

}

//select

let select = function (currency) {

    const selectHeader = document.querySelectorAll('.select__header'),
        selectItem = document.querySelectorAll('.select__item')

    function selectToggle() {
        const bottomPlate = document.querySelector('.bottom-plate')
        if (window.innerWidth < 541 && !bottomPlate.classList.contains('bottom-plate__show')) {
            return null
        }
        this.parentElement.classList.toggle('is-active')
    }

    function selectChoose() {
        const select = this.closest('.select'),
            currentText = select.querySelector('.select__current')

        currentText.innerText = this.innerText

        price(currency)

        select.classList.remove('is-active')
    }

    selectHeader.forEach(item => {
        if (!item.classList.contains('with-listener')) {
            item.classList.add('with-listener')
            item.addEventListener('click', selectToggle)
        }
    })

    selectItem.forEach(item => {
        item.addEventListener('click', selectChoose)
    })

}

select('£')

// showFullBottomPlate

function showFullBottomPlate() {
    const selectors = ['bottom-plate', 'product-logo', 'bottom-plate__first', 'product-wrapper',
        'product-title', 'review__wrapper', 'review-icon__wrapper', 'review-text',
        'bottom-plate__second', 'price__old', 'bottom-plate__third', 'select', 'select__header',
        'select__current', 'select__icon', 'select__body', 'buy-btn', 'plate__header-discount', 'header']

    selectors.forEach(item => {
        const showElem = document.querySelector(`.${item}`)
        showElem.classList.add(`${item}__show`)
    })

    const items = selectBody.getElementsByTagName('div'),
        items_arr = Array.from(items)

    items_arr.forEach(item => {
        item.classList.add(`${item.className}__show`)
    })

}

const bottomPlateWrapper = document.querySelector('.bottom-plate__wrapper')

bottomPlateWrapper.addEventListener('click', () => {
    if(document.body.clientWidth < 913) {
        showFullBottomPlate()
    }
})

window.addEventListener('scroll', () => {
    const bottomPlate = document.querySelector('.bottom-plate')
    console.log(scrollY + innerHeight)
    if (Number((scrollY + innerHeight).toFixed(0)) === document.body.scrollHeight && window.innerWidth < 913) {
        bottomPlate.classList.add('bottom-plate__fixed')
    }
})



// === // ===